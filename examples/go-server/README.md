# Go mTLS Server Example

A simple HTTP server with mTLS (mutual TLS) authentication using certificates generated by the mtls tool.

## Prerequisites

1. Go 1.21 or later
2. Generate certificates using mtls tool:

```bash
# From the mtls project root
./mtls ca create --batch --cn "Example CA" --key-type rsa4096

./mtls cert create --batch \
  --ca ./certs/ca \
  --cn "localhost" \
  --dns "localhost,127.0.0.1" \
  --ip "127.0.0.1" \
  --key-type rsa2048
```

## Running the Server

```bash
cd examples/go-server
go run main.go
```

The server will start on `https://localhost:8443`

## Testing

### Using curl

```bash
curl --cert ../../certs/servers/localhost/server-cert.pem \
     --key ../../certs/servers/localhost/server-key.pem \
     --cacert ../../certs/ca/ca-cert.pem \
     https://localhost:8443
```

### Using the Go client

```bash
cd ../go-client
go run main.go
```

## Endpoints

- `GET /` - Main endpoint, returns client certificate info
- `GET /health` - Health check endpoint
- `GET /api/data` - Returns sample data
- `POST /api/echo` - Echoes back the request body

## Features

- ✅ mTLS (mutual TLS) authentication
- ✅ Client certificate verification
- ✅ Client certificate information logging
- ✅ JSON API responses
- ✅ Multiple endpoints for testing
- ✅ Graceful error handling

## Security

- Requires valid client certificates signed by the trusted CA
- TLS 1.2+ only
- Certificate verification is mandatory
- Rejects connections without valid client certificates
